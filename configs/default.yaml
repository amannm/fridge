paths:
  samples_dir: samples
  processed_wav_dir: data/processed/wav
  manifests_dir: data/manifests
  checkpoints_dir: checkpoints
  metrics_dir: metrics
  artifacts_dir: artifacts
  thresholds_path: thresholds.yaml

run:
  seed: 1337
  device: mps
  num_workers: 2
  pin_memory: false
  deterministic: true
  log_every_steps: 25

audio:
  sample_rate: 16000
  mono: true
  trim_start_s: 10
  trim_end_s: 5

windows:
  train_win_s: 2.0
  train_hop_s: 1.0
  train_random_crop_s: [1.5, 3.0]
  eval_win_s: 2.0
  eval_hop_s: 1.0

split:
  strategy: ac_on_night_holdout
  fold: 0

model:
  backbone: models/BEATs_iter3_plus_AS2M.pt
  pooling: mean
  head:
    mlp_hidden: 128
    dropout: 0.2
  multitask:
    enabled: true
    aux_ac_weight: 0.3

train:
  batch_size: 32
  grad_accum_steps: 1
  optimizer: adamw
  weight_decay: 0.01
  grad_clip: 1.0
  schedule: warmup_cosine
  warmup_frac: 0.05

  stage1:
    freeze_backbone: true
    epochs: 8
    lr_head: 1.0e-3

  stage2:
    freeze_backbone: false
    unfreeze_last_blocks: 2
    epochs: 25
    lr_backbone: 1.0e-5
    lr_head: 3.0e-4
    early_stopping_patience: 5

augment:
  gain_db: [-6, 6]
  time_shift_s: 0.25
  mix_noise:
    p: 0.5
    snr_db: [0, 20]
  hard_negative_mix:
    p: 0.2
    snr_db: [15, 25]
  specaugment:
    enabled: true
    time_masks: 2
    time_mask_frames: 20
    freq_masks: 1
    freq_mask_bins: 12

eval:
  threshold_sweep:
    on_values: [0.55, 0.6, 0.65, 0.7]
    off_values: [0.3, 0.35, 0.4, 0.45]

streaming:
  buffer_s: 2.0
  update_every_s: 0.5
  ema_alpha: 0.2
  hysteresis_on: 0.65
  hysteresis_off: 0.35
  audio_device_index: null
  block_size: 0
  latency: null
